start:
	say "Salut je suis ton assistant de recherche netflix !"
	goto what_type

what_type:
	say Question("Qu'est-ce que tu recherches ?",
	buttons=[
		Button("Un film ğŸ¬") as btnmovie,
		Button("Une sÃ©rie ğŸ‘®â€â™‚ï¸") as btnserie,
		Button("J'aime tout ğŸ˜") as btnany
		])
	hold
	if (event match btnmovie) {
		remember type = "movie"
	}
	else if (event match btnserie) {
		remember type = "serie"
	} else {
    remember type = "any"
  }
  goto what_genre


// ############################################################
// Ã€ toi de jouer maintenant, il va falloir remplir les trous !
// ############################################################
what_genre:
  // 1 - Ã‰cris la question que va poser le chatbot Ã  l'utilisateur
  say Question("Quel est le genre de {{type}} que tu aimes ?",
	buttons=[
    Button("action"),
    Button("anime"),
    Button("documentaires"),
    Button("drame"),
    Button("famille"),
    Button("horreur"),
    Button("musique"),
    Button("nature"),
    Button("romance"),
    Button("sciencefiction"),
    Button("thriller")
		])
    // 2 - Indique au chatbot d'attendre la rÃ©ponse de l'utilisateur ici
    hold
    // 3 - Indique au chatbot qu'il doit se souvenir de la rÃ©ponse de l'utilisateur
    // en la mettant dans une variable qu'on appelera  "genre"
    remember genre = event
    goto what_year
  
what_year:
  // 4 - Demande Ã  l'utilisateur si il souhaite une annÃ©e en particulier
  // cette question a un seul bouton "Non", que tu mettras dans la variable btnnon
  say Question("Est-ce que tu souhaites une annÃ©e en particulier, si oui prÃ©cise ?",
	buttons=[
		Button("Non ğŸ™…â€â™€ï¸") as btnnon
		])
  hold
  if (event match btnnon) {
    remember year = "any"
  } else {
    remember year = event
  }
  // 5 - Indique au chatbot qu'il doit se rendre Ã  l'Ã©tape is_sorted
  goto is_sorted


is_sorted:
  // 6 - Demande Ã  l'utilisateur si il souhaite que les rÃ©sultats soient trier par date
  // Ajoute deux boutons : oui et non
  say Question("Est-ce que tu souhaites que les rÃ©sultats soient trier par dates ?",
	buttons=[
		Button("Oui ğŸ¤©") as btnoui,
		Button("Non ğŸ™…â€â™€ï¸") as btnnon
		])
  // 7 - Indique au chatbot d'attendre la rÃ©ponse de l'utilisateur ici
  hold
  // 8 - Si l'utilisateur clique sur oui, crÃ©e une variable "sort" et mets le mot "true" Ã  l'interieur
  if (event match btnoui) {
    remember sort = true
  } else {
    remember sort = false
  }
  // 9 - Indique au chatbot qu'il doit se rendre Ã  l'Ã©tape display
  goto display

display:
  // 10 - Remplacez ci-dessous les mots avec les variables
  do res = Fn("netflix/catalog", genre=genre, type=type, sort=sort, year=year)
  do cards = []
  if (res.length() == 0) {
    say "Je n'ai pas trouvÃ© de film, dÃ©solÃ© ğŸ˜”"
  }
  foreach (val, index) in res {
    do newCard = Card(
      title=val.title,
      subtitle=val.synopsis,
      image_url=val.img,
      buttons=[Button("En savoir plus", payload=val.title)]
    )
    if (index < 6) do cards.push(newCard)
  }
  say Carousel(
    cards = cards
  )
  goto moreInfos

moreInfos:
  hold
  if (event == "Chercher d'autres films") goto start
  say Url("https://www.netflix.com/search?q={{event}}", text="{{event}} sur Netflix")
  say Button("Chercher d'autres films")
  goto moreInfos

